<template>
  <div class="messenger">
  	<a class="btn" target="_blank" :href="href">
      <i class="fab" :class="iconClass"></i>
    </a>
  	<div class="bubble" v-if="bubble.show">
  		<div class="close" @click="close()">‚úï</div>
  		<div class="text">
  			<span>{{bubble.text}}</span> –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—Å—É–¥–∏—Ç—å –≤ —É–¥–æ–±–Ω–æ–º –¥–ª—è –≤–∞—Å –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ üôÇ
  		</div>
  	</div>
  </div>
</template>

<script>
export default {
  name: 'Messenger',
  data() {
    return {
  	  bubble: {
  		  show: true,
  		  text: 'üëã –•–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –ø—Ä–æ–µ–∫—Ç?'
  	  },
  	  source: this.$route.query.utm_source
    }
  },
  methods: {
    close(){
      this.bubble.show = false
      //ym(this.ym, 'reachGoal', 'close')
    },
    message(){
      //ym(this.ym, 'reachGoal', 'message')
    },
    updateBubbleText(){
      if(this.source){
        this.bubble.text = 'üëã –ü–æ–Ω—Ä–∞–≤–∏–ª—Å—è ' + this.source + '.ru? –•–æ—Ç–∏—Ç–µ —Ç–∞–∫–æ–π –∂–µ —Å–∞–π—Ç?'
      }
    }
  },
  computed: {
    href() {
      return this.$mq === 'mobile'
      ? 'https://api.whatsapp.com/send?phone=79261118328&text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–ú–µ–Ω—è%20–∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç%20'
      : 'https://t-do.ru/sfilimonov'
    },
    iconClass() {
      return this.$mq === 'mobile'
      ? 'fa-whatsapp'
      : 'fa-telegram-plane'
    }
  },
  mounted() {
    this.updateBubbleText()
  }
}
</script>

<style lang="scss">
.messenger {
  .btn {
    display: flex;
    z-index: 10000;
    background: #fff;
    width: 64px;
    height: 64px;
    align-items: center;
    justify-content: center;
    border-radius: 1000px;
    box-shadow: 0px 4px 20px rgba(0,0,0,0.2);
    color: black;
    position: fixed;
    bottom: 26px;
    right: 26px;
    transition: .4s;
    i {
      font-size: 36px;
      margin-right: 0;
    }
    .fa-telegram-plane {
      position: relative;
      left: -2px;
      top: 1px
    }
    &:hover {
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
    }
    .fa-whatsapp {
      color: #25D366;
    }
    .fa-telegram-plane {
      color: #36ADE1;
    }
  }
  .bubble {
    box-shadow: 0px 4px 26px -4px rgba(0,0,0,0.2);
    padding: 1rem;
    z-index: 10000;
    bottom: 26px;
    right: 100px;
    transition: .4s;
    position: fixed;
    border-radius: 8px;
    background: #fff;
    max-width: 240px;
    line-height: 1.4;
    &:hover {
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
    }
    span {
      font-weight: 700;
    }
    .close {
      position: absolute;
      display: flex;
      justify-content: center;
      align-items: center;
      left: -12px;
      top: -12px;
      font-size: 12px;
      &:hover {
        cursor: pointer;
      }
    }
    .text {
      @media only screen and (max-width: 568px) {
        font-size: 16px !important;
      }
    }
  }
}
</style>
